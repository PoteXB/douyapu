function md5(t){function s(t,e){return t<<e|t>>>32-e}function p(t,e){var i,n,o,a,r;return o=2147483648&t,a=2147483648&e,r=(1073741823&t)+(1073741823&e),(i=1073741824&t)&(n=1073741824&e)?2147483648^r^o^a:i|n?1073741824&r?3221225472^r^o^a:1073741824^r^o^a:r^o^a}function e(t,e,i,n,o,a,r){return p(s(t=p(t,p(p((l=e)&i|~l&n,o),r)),a),e);var l}function i(t,e,i,n,o,a,r){return p(s(t=p(t,p(p(e&(l=n)|i&~l,o),r)),a),e);var l}function n(t,e,i,n,o,a,r){return p(s(t=p(t,p(p(e^i^n,o),r)),a),e)}function o(t,e,i,n,o,a,r){return p(s(t=p(t,p(p(i^(e|~n),o),r)),a),e)}function a(t){var e,i="",n="";for(e=0;e<=3;e++)i+=(n="0"+(t>>>8*e&255).toString(16)).substr(n.length-2,2);return i}var r,l,c,m,d,h,g,f,u,b;for(b=function(t){for(var e,i=t.length,n=i+8,o=16*((n-n%64)/64+1),a=new Array(o-1),r=0,l=0;l<i;)r=l%4*8,a[e=(l-l%4)/4]=a[e]|t.charCodeAt(l)<<r,l++;return r=l%4*8,a[e=(l-l%4)/4]=a[e]|128<<r,a[o-2]=i<<3,a[o-1]=i>>>29,a}(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);n<128?e+=String.fromCharCode(n):(127<n&&n<2048?e+=String.fromCharCode(n>>6|192):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128)),e+=String.fromCharCode(63&n|128))}return e}(t)),h=1732584193,g=4023233417,f=2562383102,u=271733878,r=0;r<b.length;r+=16)g=o(g=o(g=o(g=o(g=n(g=n(g=n(g=n(g=i(g=i(g=i(g=i(g=e(g=e(g=e(g=e(c=g,f=e(m=f,u=e(d=u,h=e(l=h,g,f,u,b[r+0],7,3614090360),g,f,b[r+1],12,3905402710),h,g,b[r+2],17,606105819),u,h,b[r+3],22,3250441966),f=e(f,u=e(u,h=e(h,g,f,u,b[r+4],7,4118548399),g,f,b[r+5],12,1200080426),h,g,b[r+6],17,2821735955),u,h,b[r+7],22,4249261313),f=e(f,u=e(u,h=e(h,g,f,u,b[r+8],7,1770035416),g,f,b[r+9],12,2336552879),h,g,b[r+10],17,4294925233),u,h,b[r+11],22,2304563134),f=e(f,u=e(u,h=e(h,g,f,u,b[r+12],7,1804603682),g,f,b[r+13],12,4254626195),h,g,b[r+14],17,2792965006),u,h,b[r+15],22,1236535329),f=i(f,u=i(u,h=i(h,g,f,u,b[r+1],5,4129170786),g,f,b[r+6],9,3225465664),h,g,b[r+11],14,643717713),u,h,b[r+0],20,3921069994),f=i(f,u=i(u,h=i(h,g,f,u,b[r+5],5,3593408605),g,f,b[r+10],9,38016083),h,g,b[r+15],14,3634488961),u,h,b[r+4],20,3889429448),f=i(f,u=i(u,h=i(h,g,f,u,b[r+9],5,568446438),g,f,b[r+14],9,3275163606),h,g,b[r+3],14,4107603335),u,h,b[r+8],20,1163531501),f=i(f,u=i(u,h=i(h,g,f,u,b[r+13],5,2850285829),g,f,b[r+2],9,4243563512),h,g,b[r+7],14,1735328473),u,h,b[r+12],20,2368359562),f=n(f,u=n(u,h=n(h,g,f,u,b[r+5],4,4294588738),g,f,b[r+8],11,2272392833),h,g,b[r+11],16,1839030562),u,h,b[r+14],23,4259657740),f=n(f,u=n(u,h=n(h,g,f,u,b[r+1],4,2763975236),g,f,b[r+4],11,1272893353),h,g,b[r+7],16,4139469664),u,h,b[r+10],23,3200236656),f=n(f,u=n(u,h=n(h,g,f,u,b[r+13],4,681279174),g,f,b[r+0],11,3936430074),h,g,b[r+3],16,3572445317),u,h,b[r+6],23,76029189),f=n(f,u=n(u,h=n(h,g,f,u,b[r+9],4,3654602809),g,f,b[r+12],11,3873151461),h,g,b[r+15],16,530742520),u,h,b[r+2],23,3299628645),f=o(f,u=o(u,h=o(h,g,f,u,b[r+0],6,4096336452),g,f,b[r+7],10,1126891415),h,g,b[r+14],15,2878612391),u,h,b[r+5],21,4237533241),f=o(f,u=o(u,h=o(h,g,f,u,b[r+12],6,1700485571),g,f,b[r+3],10,2399980690),h,g,b[r+10],15,4293915773),u,h,b[r+1],21,2240044497),f=o(f,u=o(u,h=o(h,g,f,u,b[r+8],6,1873313359),g,f,b[r+15],10,4264355552),h,g,b[r+6],15,2734768916),u,h,b[r+13],21,1309151649),f=o(f,u=o(u,h=o(h,g,f,u,b[r+4],6,4149444226),g,f,b[r+11],10,3174756917),h,g,b[r+2],15,718787259),u,h,b[r+9],21,3951481745),h=p(h,l),g=p(g,c),f=p(f,m),u=p(u,d);return(a(h)+a(g)+a(f)+a(u)).toLowerCase()}var cssStyle='.userInfo,.userInfo .users .color-normal{color:#4c4c4c}.entry,.list{border-top:1px solid #ededed}.app,.item,.item-img,.list,.list-container,.list-tao,sub,sup{position:relative}.btn,.item-img,.item-title,.list-nav-item{cursor:pointer}*{margin:0;padding:0}html{font-family:"Microsoft YaHei",sans-serif}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}.app{width:380px;height:502px;padding:0 20px}.userInfo{zoom:1;font-size:14px;line-height:14px}.userInfo .users{margin:12px 0}.entry{text-align:center;height:144px;transition:height linear .3s}.entry,.list{overflow:hidden}.entry,.list-more,.more-market{text-decoration:none}.partner-banner{padding:0;margin:18px 0 0;display:flex;flex-decoration:column;justify-content:space-between}.partner-banner .banner-itm{list-style:none}.partner-banner .banner-itm:nth-child(1) a{box-shadow:0 3px 5px rgba(225,26,45,.4)}.partner-banner .banner-itm:nth-child(2) a{box-shadow:0 3px 5px rgba(253,120,7,.4)}.partner-banner .banner-itm:nth-child(3) a{box-shadow:0 3px 5px rgba(252,79,6,.4)}.partner-banner .entry-market{display:block;height:38px;width:120px}.partner-banner .banner-title{padding:0;margin:8px 0 0;color:#f40;font-size:12px;line-height:12px}.more-market{display:block;color:#4c4c4c;border-radius:2px;background:#f7f8f9;margin:14px 0 22px;letter-spacing:1px;font-size:14px;line-height:30px}.list{line-height:1;height:330px}.list-nav{display:flex;justify-content:flex-end;font-size:14px;color:#2c91ff}.list-nav-item{margin:10px 20px 10px 0;text-align:right;font-weight:700}.list-tao{height:264px;overflow-y:scroll;overflow-x:hidden;transition:all linear .3s}.list-tao::-webkit-scrollbar{width:8px}.list-tao::-webkit-scrollbar-thumb{border-radius:8px;background:#e1e1e1}.item-img,.item-img:before{background-repeat:no-repeat}.item{display:flex;margin-bottom:20px}.item-img,.list-cover{background-color:#fff}.item-img{flex:0 0 auto;width:80px;height:80px;background-size:100% auto;background-position:center}.item-img:after,.item-img:before{content:"";width:100%;height:100%;position:absolute}.item-img:before{background-position:left bottom}.item-img:hover:after{background:rgba(255,255,255,.15)}.item-info{flex:1 1 auto;padding-left:12px}.item-title-wrap{margin:8px 0;font-size:14px}.item-title{display:inline-block;width:270px;font-weight:400;color:#4c4c4c;overflow:hidden}.item-amount,.item-title:hover{color:#a0a0a0}.item-log,.item-title{text-overflow:ellipsis;white-space:nowrap}.item-money{margin:12px 0;font-size:12px;color:#a3a3a3}.item-relMoney{font-size:12px;color:#444}.btn{position:absolute;right:10px;bottom:10px;height:35px;border-radius:3px;background:#F63;color:#fff;padding:0 10px;line-height:35px}.list-cover{position:absolute;width:100%;height:100%;top:0;left:0}.list-main-snake{position:absolute;top:0;right:0;bottom:0;left:0;margin:auto;width:28px;height:28px}.spin-snake{border:4px solid transparent;border-top-color:#e1e1e1;border-left-color:#e1e1e1;border-right-color:#e1e1e1;border-radius:50%;animation:rot .8s infinite linear}.noList{width:100%;height:100%;text-align:center;font-size:14px;color:#4c4c4c;line-height:250px}@keyframes rot{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}';$("<style></style>").html(cssStyle).appendTo("head");var cssStyle1212="";$("<style></style>").html(cssStyle1212).appendTo("head"),$("body").append('<div class="app">\n    <div class="userInfo">\n        <section>\n            <div class="users"><span class="color-normal">购物单</span></div>\n        </section>\n    </div>\n    <div class="entry">\n        <ul class="partner-banner"></ul>\n        <a target="_blank" href="" class="more-market">淘抢购</a>\n    </div>\n    <div class="list">\n        <div class="list-nav"><span class="list-nav-item">换一批</span></div>\n        <article class="list-tao"></article>\n        <div class="list-cover">\n            <div class="spin-snake list-main-snake"></div>\n        </div>\n    </div>\n</div>');var dataTop=[{url:"https://www.tmall.com/",img:"https://img.alicdn.com/tps/TB15cDeLVXXXXchXXXXXXXXXXXX-120-40.png",title:"天猫"},{url:"https://uland.taobao.com/coupon/list",img:"https://img.alicdn.com/tfs/TB1BswrQpXXXXXMXXXXXXXXXXXX-120-40.png",title:"先领券，再下单"},{url:"https://ai.taobao.com/",img:"https://img.alicdn.com/tps/TB1Km0fLpXXXXXhapXXXXXXXXXX-120-40.png",title:"爱淘宝"}],dataMid={url:"https://qiang.taobao.com/?sellerType=3",title:"淘抢购"},htmlTop="";$.each(dataTop,function(t,e){htmlTop+='<li class="banner-itm">\n        <a target="_blank" href="'+e.url+'" class="entry-market" style="background: url('+e.img+');"> </a>\n        <p class="banner-title">'+e.title+"</p>\n    </li>"}),$(".partner-banner").html(htmlTop),$(".more-market").attr("href",dataMid.url).html(dataMid.title);var tbCookie="",page=0,num=0,floorId=0;function getTbCookie(e){chrome.cookies.get({url:"https://www.taobao.com/",name:"_m_h5_tk"},function(t){t&&t.value?(tbCookie=t.value,e&&e()):($("body").append('<iframe src="https://h5.m.taobao.com/" id="yangxue9527" style="display:none"></iframe>'),setTimeout(function(){$("#yangxue9527").remove(),getTbCookie(e)},2e3))})}function getCoupon(){var t=Date.now(),e='{"pNum":'+page+',"pSize":10,"floorId":'+floorId+',"refpid":"","couponSrc":"default"}';$.ajax({url:"https://h5api.m.taobao.com/h5/mtop.alimama.union.xt.en.api.entry/1.0/",dataType:"json",data:{jsv:"2.4.0",appKey:"12574478",t:t,api:"mtop.alimama.union.xt.en.api.entry",v:"1.0",AntiCreep:!0,sign:md5(tbCookie.split("_")[0]+"&"+t+"&12574478&"+e),data:e},success:function(t){if(t&&t.ret&&t.ret[0]&&t.ret[0].match("调用成功")){var e="";try{e=t.data.recommend.resultList}catch(t){}appendHtml(e)}else if(t&&t.ret&&t.ret[0]&&t.ret[0].match("FAIL_BIZ_EMPTY_RESULT::FAIL_BIZ_EMPTY_RESULT"))page=0,getCoupon();else{if(3==++num)return appendHtml(0),!1;getTbCookie(getCoupon)}},error:function(){if(3==++num)return appendHtml(0),!1;getCoupon()}})}function appendHtml(t){if($(".list-cover").hide(),t)if(t.length){var i="";$.each(t,function(t,e){i+='<div class="item">\n                    <a href="" target="_blank" class="item-img" style="background-image: url(http:'+e.pic+'_80x80.jpg);">\n                    </a>\n                    <div class="item-info">\n                        <p class="item-title-wrap">\n                            <a href="" target="_blank" title="'+e.itemName+'" class="item-title">\n                                '+e.itemName+'\n                            </a>\n                        </p>\n                        <p class="item-money">￥'+e.promotionPrice+'</p>\n                        <p class="item-relMoney">券后价￥'+e.priceAfterCoupon+'</p>\n                        <a href="" target="_blank"><div class="btn">领 '+e.couponAmount+" 元券</div></a>\n                    </div>\n                </div>"}),$(".list-tao").html(i)}else $(".list-tao").html("<div class='noList'>这次是真的没有啦 , 请稍后再来吧</div>");else $(".list-tao").html("<div class='noList'>网络有点开小差了 , 请稍后再试吧~</div>")}chrome.storage.local.get(null,function(t){switch(t.productId1013){case"1":floorId=4867;break;case"2":floorId=4862;break;case"3":floorId=4903;break;case"4":floorId=4251;break;case"5":floorId=4865;break;default:floorId=4866}getTbCookie(getCoupon)}),$(".list-nav-item").click(function(){$(".list-cover").show(),page++,getCoupon()});